{% extends "layout.html" %}

{% block content %}

<div id="name" style="display:none">{{name}}</div>

<div class="center" style="height: 100vh;"> 

    <!-- <video id="exercise-video" controls controlsList="noplaybackrate nodownload" disablePictureInPicture=true; style="padding-top: 3%; padding-bottom: 2%;">
        <source src="{{ video }}" type="video/youtube">
    </video> -->

    <iframe id="exercise-video" width="1120" height="630" src="{{video}}" autoplay="0" frameborder="0" allow="aclipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    
    <div style="width: 100vh; margin: 0 auto;"> 
        <form method="POST">        
            <button id="next-button" class="glow-button" type="submit">
                {% if status == 2 %}
                Continue
                {% else %}
                Next
                {% endif %}
            </button>
        </form>
    </div>

</div>


<script>

    var video=document.getElementById("exercise-video")
    
    // Enables buton on video end 
    var button_next=document.getElementById("next-button")
    var str=document.getElementById("name").innerHTML
    video.onended = function() {
        button_next.disabled = false
    }
    
    // Prevents seek
    // currTime stores the expected timestamp of the video when no seeking occurs
    var currTime = 0
    video.addEventListener("timeupdate", function() {
        if (!video.seeking) {
            currTime = video.currentTime
        }
    })
    // If user attempts to seek, the video current time is compared with the local
    // currTime and currTime is set as the current video time.
    video.addEventListener("seeking", function() {
        var diff = video.currentTime - currTime
        if (Math.abs(diff) > 0.01) {
            video.currentTime = currTime
        }
    })
    // Allows for rewatching of video
    video.addEventListener("ended", function() {
        currTime = 0
    })
    // Link to solution: https://stackoverflow.com/questions/11903545/how-to-disable-seeking-with-html5-video-tag#:~:text=You%20could%20use%20an%20HTML5%20video%20player%20like,Also%2C%20the%20event%20you%27re%20looking%20for%20is%20%27seeking%27.

</script>

{% endblock content %}